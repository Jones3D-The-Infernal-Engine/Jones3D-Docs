
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="cog_ai/">
      
      
      <link rel="icon" href="../assets/img/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>COG Script - OpenJones3D</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M17.8%2020c-.4%201.2-1.5%202-2.8%202H5c-1.7%200-3-1.3-3-3v-1h12.2c.4%201.2%201.5%202%202.8%202zM19%202c1.7%200%203%201.3%203%203v1h-2V5c0-.6-.4-1-1-1s-1%20.4-1%201v13h-1c-.6%200-1-.4-1-1v-1H5V5c0-1.7%201.3-3%203-3zM8%206v2h7V6zm0%204v2h6v-2z%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="indy" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cog-script" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="OpenJones3D" class="md-header__button md-logo" aria-label="OpenJones3D" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.009 13.386c1.577 0 3.86-.326 3.86-2.202a1.8 1.8 0 0 0-.04-.431l-.94-4.08c-.216-.898-.406-1.305-1.982-2.093-1.223-.625-3.888-1.658-4.676-1.658-.733 0-.947.946-1.822.946-.842 0-1.467-.706-2.255-.706-.757 0-1.25.515-1.63 1.576 0 0-1.06 2.99-1.197 3.424a.8.8 0 0 0-.028.245c0 1.162 4.577 4.974 10.71 4.974m4.101-1.435c.218 1.032.218 1.14.218 1.277 0 1.765-1.984 2.745-4.593 2.745-5.895.004-11.06-3.451-11.06-5.734a2.3 2.3 0 0 1 .19-.925C2.746 9.415 0 9.794 0 12.217c0 3.969 9.405 8.861 16.851 8.861 5.71 0 7.149-2.582 7.149-4.62 0-1.605-1.387-3.425-3.887-4.512"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenJones3D
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              COG Script
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/smlu/OpenJones3D/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    smlu/OpenJones3D
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="OpenJones3D" class="md-nav__button md-logo" aria-label="OpenJones3D" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.009 13.386c1.577 0 3.86-.326 3.86-2.202a1.8 1.8 0 0 0-.04-.431l-.94-4.08c-.216-.898-.406-1.305-1.982-2.093-1.223-.625-3.888-1.658-4.676-1.658-.733 0-.947.946-1.822.946-.842 0-1.467-.706-2.255-.706-.757 0-1.25.515-1.63 1.576 0 0-1.06 2.99-1.197 3.424a.8.8 0 0 0-.028.245c0 1.162 4.577 4.974 10.71 4.974m4.101-1.435c.218 1.032.218 1.14.218 1.277 0 1.765-1.984 2.745-4.593 2.745-5.895.004-11.06-3.451-11.06-5.734a2.3 2.3 0 0 1 .19-.925C2.746 9.415 0 9.794 0 12.217c0 3.969 9.405 8.861 16.851 8.861 5.71 0 7.149-2.582 7.149-4.62 0-1.605-1.387-3.425-3.887-4.512"/></svg>

    </a>
    OpenJones3D
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/smlu/OpenJones3D/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    smlu/OpenJones3D
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  <span class="md-ellipsis">
    COG
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            COG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_jones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jones System COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_player/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Player COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_sector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sector COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_sound/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sound COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_surface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Surface COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_thing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thing COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cog_voice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Voice COG functions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      File Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#symbols-section" class="md-nav__link">
    <span class="md-ellipsis">
      Symbols Section
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Symbols Section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cog-symbol-type" class="md-nav__link">
    <span class="md-ellipsis">
      COG Symbol Type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cog-symbol-reference-type" class="md-nav__link">
    <span class="md-ellipsis">
      COG Symbol Reference Type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cog-symbol-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      COG Symbol Attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cog-messages" class="md-nav__link">
    <span class="md-ellipsis">
      COG Messages
    </span>
  </a>
  
    <nav class="md-nav" aria-label="COG Messages">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-damaged" class="md-nav__link">
    <span class="md-ellipsis">
      Message: damaged
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-callback" class="md-nav__link">
    <span class="md-ellipsis">
      Message: callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-created" class="md-nav__link">
    <span class="md-ellipsis">
      Message: created
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-initialized" class="md-nav__link">
    <span class="md-ellipsis">
      Message: initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-removed" class="md-nav__link">
    <span class="md-ellipsis">
      Message: removed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-user0" class="md-nav__link">
    <span class="md-ellipsis">
      Message: user0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message-user2" class="md-nav__link">
    <span class="md-ellipsis">
      Message: user2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cog-host-functions" class="md-nav__link">
    <span class="md-ellipsis">
      COG Host Functions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="cog-script">COG Script</h1>
<p>COG script is a script language used in the game to define game logic. Scripts are written in files with a <code>.cog</code> extension, which are loaded and compiled to bytecode by the game engine. The resulting bytecode is then executed by the engine. COG scripts can be attached to game objects (such as Things, Actors, etc.) in the <a href="ndy.md#section-templates">template section</a> or set as part of the level <a href="ndy.md#section-cogs">COG system</a>.</p>
<h2 id="file-structure">File Structure</h2>
<p>The script file is divided into 3 sections: flags, symbols and code, each of which is ended with the <code>end</code> keyword. The flags section is optional and can be omitted. Info on all available flags can be found in <a href="flags.md#cog-flags">flags.md#cog-flags</a>. The <code>symbols</code> section defines the script variables and the <code>code</code> section defines script code.</p>
<p>Example:
<div class="highlight"><pre><span></span><code>flags 0x40 # optional
symbols
  message startup
  message entered

  int a = 1  
  material mat = material.mat local
  surface surf
  sector surfSector nolink local
  thing player local
end

code
  startup:
    player = GetLocalPlayerThing();
    sector = GetSurfaceSector(surf);
    return;

  entered:
    # If player stepped on the surface, damage him
    if (GetSenderRef() == surf)
    {
      DamageThing(player, 100, 0x01, -1); # 0x01 is impact damage type
    }
    return;
end
</code></pre></div></p>
<h3 id="symbols-section">Symbols Section</h3>
<p>The <code>symbols</code> section defines the script variables. Each variable is defined on a separate line. The variable type is defined by the first keyword, followed by the variable name, optional initialization value, and symbol attributes. </p>
<div class="highlight"><pre><span></span><code>&lt;type&gt; &lt;name&gt; = &lt;value&gt; &lt;attributes&gt;
</code></pre></div>
<h4 id="cog-symbol-type">COG Symbol Type</h4>
<p>The variable type can be one of the following:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ai</code></td>
<td><code>.ai</code> filename</td>
<td>AI class</td>
</tr>
<tr>
<td><code>cog</code></td>
<td>Index in COG list</td>
<td>Level COG</td>
</tr>
<tr>
<td><code>flex</code></td>
<td>Integer or float</td>
<td>Decimal number or script function</td>
</tr>
<tr>
<td><code>float</code></td>
<td>Float</td>
<td>Decimal number</td>
</tr>
<tr>
<td><code>int</code></td>
<td>Int</td>
<td>Integer number</td>
</tr>
<tr>
<td><code>keyframe</code></td>
<td><code>.KEY</code> filename</td>
<td>Keyframe animation</td>
</tr>
<tr>
<td><code>material</code></td>
<td><code>.MAT</code> filename</td>
<td>Texture material</td>
</tr>
<tr>
<td><code>message</code></td>
<td>None</td>
<td>Special symbol type that defines an event message. The name must be one of the 48 predefined messages. See <a href="#cog-messages">COG Messages</a>.</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>.3DO</code> filename</td>
<td>3D model</td>
</tr>
<tr>
<td><code>sector</code></td>
<td>Index in sector list</td>
<td>Level sector</td>
</tr>
<tr>
<td><code>sound</code></td>
<td><code>.WAV</code> filename</td>
<td>Sound file</td>
</tr>
<tr>
<td><code>sprite</code></td>
<td><code>.SPR</code> filename</td>
<td>Sprite file</td>
</tr>
<tr>
<td><code>surface</code></td>
<td>Index in surface list</td>
<td>Level surface</td>
</tr>
<tr>
<td><code>vector</code></td>
<td><code>(x/y/z)</code></td>
<td>Vector type</td>
</tr>
<tr>
<td><code>template</code></td>
<td>Template name</td>
<td>Game object template</td>
</tr>
<tr>
<td><code>thing</code></td>
<td>Index in the thing list</td>
<td>Game object</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All index values (e.g. for COG, sector, surface, thing) are usually defined by the level where COG script is used.</p>
</div>
<h4 id="cog-symbol-reference-type">COG Symbol Reference Type</h4>
<p>Internal value of each symbol type is defined as fixed number. This number is retrieved in the script code for example by calling <code>GetSenderType</code> or <code>GetSourceType</code>. The following table defines the type values:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>COG_SYM_REF_NONE</code></td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td><code>COG_SYM_REF_INT</code></td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td><code>COG_SYM_REF_FLEX</code></td>
<td style="text-align: right;">2</td>
</tr>
<tr>
<td><code>COG_SYM_REF_THING</code></td>
<td style="text-align: right;">3</td>
</tr>
<tr>
<td><code>COG_SYM_REF_TEMPLATE</code></td>
<td style="text-align: right;">4</td>
</tr>
<tr>
<td><code>COG_SYM_REF_SECTOR</code></td>
<td style="text-align: right;">5</td>
</tr>
<tr>
<td><code>COG_SYM_REF_SURFACE</code></td>
<td style="text-align: right;">6</td>
</tr>
<tr>
<td><code>COG_SYM_REF_KEYFRAME</code></td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td><code>COG_SYM_REF_SOUND</code></td>
<td style="text-align: right;">8</td>
</tr>
<tr>
<td><code>COG_SYM_REF_COG</code></td>
<td style="text-align: right;">9</td>
</tr>
<tr>
<td><code>COG_SYM_REF_MATERIAL</code></td>
<td style="text-align: right;">10</td>
</tr>
<tr>
<td><code>COG_SYM_REF_VECTOR</code></td>
<td style="text-align: right;">11</td>
</tr>
<tr>
<td><code>COG_SYM_REF_MODEL</code></td>
<td style="text-align: right;">12</td>
</tr>
<tr>
<td><code>COG_SYM_REF_AICLASS</code></td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
<h4 id="cog-symbol-attributes">COG Symbol Attributes</h4>
<p>All attributes are optional and can be omitted when defining the variable. The attribute can't be set for the <code>message</code> type.</p>
<p>The following attributes are available:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Symbol Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>desc</code></td>
<td>all</td>
<td>The variable description. This attribute is used by level editor.</td>
</tr>
<tr>
<td><code>linkid</code></td>
<td>non-arithmetic</td>
<td>The variable link ID refers to an identifier that can be assigned to variables. This ID can then be retrieved in the script code by calling the host function <code>GetSenderId</code>. The link ID is useful for grouping variables that would trigger the same code logic.<br><br>For example, instead of checking if the sender is one of the surface: <code>if( GetSenderRef() == surf1 or GetSenderRef() == surf2 )</code> you could assign the same link ID, e.g.: 2 to those surfaces and refactor code to: <code>if ( GetSenderId() == 2 )</code> <br><br>If link ID is not set the default value is 0. Setting link ID to less than 0 i.e. -1 will not link the symbol to script. The same <code>nolink</code> attribute.</td>
</tr>
<tr>
<td><code>local</code></td>
<td>all</td>
<td>The variable is local to the script and it can't be initialized from the level file.</td>
</tr>
<tr>
<td><code>mask</code></td>
<td>non-arithmetic</td>
<td>The mask defines which game object types (see <a href="ndy.md#thing-type">Thing type</a>) trigger the message event for the variable in the script. What that means is that when an object of the specified type interacts with the object that the variable references, a specific message will be sent to the script with the masked object as the source and the referenced object as the sender. For example, if a variable named <code>surf</code> has a mask set for the Player type, and a player activates the referenced object, the message <code>activated</code> will be sent to the script with the player as the source and the <code>surf</code> object as the sender. <br><br>The mask value is hexadecimal number where each bit represents one game object type. To achieve this, each game type needs to be converted to a power of 2. For example, the player type mask would be represented as 0x400 = 2^10.<br>By default, every variable is set with a mask of <code>0x401</code>, which corresponds to the Player &amp; Free object mask. The mask for the free object type is used when there is no source trigger object.</td>
</tr>
<tr>
<td><code>nolink</code></td>
<td>non-arithmetic</td>
<td>The variable is not linked to the script, i.e. it won't trigger any event message in the script.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Non-arithmetic symbols are: <code>ai</code>, <code>cog</code>, <code>keyframe</code>, <code>material</code>, <code>model</code>, <code>sector</code>, <code>sound</code>, <code>sprite</code>, <code>surface</code>, <code>template</code>, <code>thing</code>.</p>
</div>
<h2 id="cog-messages">COG Messages</h2>
<p>COG message is the core of COG script logic, here the COG script code is written. Each COG message section begins with message name followed by colon (':') and ends with return statement e.g.: <code>return;</code>.</p>
<p>e.g.:</p>
<p><div class="highlight"><pre><span></span><code><span class="nl">somemessage</span><span class="p">:</span>
<span class="w">  </span><span class="p">...</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="p">...</span>
<span class="w">  </span><span class="k">return</span><span class="p">;</span>
</code></pre></div>
Each message is called with following parameters:</p>
<table>
<thead>
<tr>
<th>Param</th>
<th style="text-align: center;">Type</th>
<th style="text-align: center;">Retrieve Function</th>
<th style="text-align: center;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SenderType</code></td>
<td style="text-align: center;"><a href="#cog-symbol-reference-type">Symbol Reference Type</a></td>
<td style="text-align: center;"><code>GetSenderType</code></td>
<td style="text-align: center;">The type of the sender which sent the message</td>
</tr>
<tr>
<td><code>Sender</code></td>
<td style="text-align: center;">SymbolType</td>
<td style="text-align: center;"><code>GetSenderRef</code></td>
<td style="text-align: center;">The sender which sent the message<br/>e.g.: Sector, Surface, Actor, Player</td>
</tr>
<tr>
<td><code>SenderLinkId</code></td>
<td style="text-align: center;"><code>int</code></td>
<td style="text-align: center;"><code>GetSenderID</code></td>
<td style="text-align: center;">The link ID of the sender. (e.g.: set with <code>linkid</code> param at sender variable declaration)</td>
</tr>
<tr>
<td><code>SourceType</code></td>
<td style="text-align: center;"><a href="#cog-symbol-reference-type">Symbol Reference Type</a></td>
<td style="text-align: center;"><code>GetSourceType</code></td>
<td style="text-align: center;">The type of the source which initiate the sent message</td>
</tr>
<tr>
<td><code>Source</code></td>
<td style="text-align: center;">SymbolType</td>
<td style="text-align: center;"><code>GetSourceRef</code></td>
<td style="text-align: center;">The source which initiate the sent message<br/>e.g.: Player is source which step on the surface = sender which sent COG message</td>
</tr>
<tr>
<td><code>Param0</code></td>
<td style="text-align: center;">Any Type</td>
<td style="text-align: center;"><code>GetParam(0)</code></td>
<td style="text-align: center;">Message extra parameter 0</td>
</tr>
<tr>
<td><code>Param1</code></td>
<td style="text-align: center;">Any Type</td>
<td style="text-align: center;"><code>GetParam(1)</code></td>
<td style="text-align: center;">Message extra parameter 1</td>
</tr>
<tr>
<td><code>Param2</code></td>
<td style="text-align: center;">Any Type</td>
<td style="text-align: center;"><code>GetParam(2)</code></td>
<td style="text-align: center;">Message extra parameter 2</td>
</tr>
<tr>
<td><code>Param3</code></td>
<td style="text-align: center;">Any Type</td>
<td style="text-align: center;"><code>GetParam(3)</code></td>
<td style="text-align: center;">Message extra parameter 3</td>
</tr>
</tbody>
</table>
<p>There are 48 predefined COG messages:</p>
<table id="cog-messages">
  <tr>
    <td><strong>1.</strong> <code>activate</code></td>
    <td><strong>17.</strong> <code>activated</code></td>
    <td><strong>33.</strong><code>aievent</code>params:
    <ul>
    <li><code>p0</code> = <code>aiEventType</code></li>
    <li><code>p1</code> = current AI mode</li>
    <li><code>p2</code> = depends on <code>aiEventType</code></li>
    </ul>
    eg.: <code>aiEventType = 0x100</code> (<code>aiModeChanged</code>), <code>p1 = oldMode</code>, <code>p2 = newMode</code></td>
  </tr>
  <tr>
    <td><strong>2.</strong> <code>aim</code></td>
    <td><strong>18.</strong> <code>arrived</code></td>
    <td><strong>34.</strong> <code>arrivedwpnt</code></td>
  </tr>
  <tr>
    <td><strong>3.</strong> <code>blocked</code></td>
    <td><strong>19.</strong> <code>boarded</code></td>
    <td><strong>35.</strong> <code><a href="#message-callback">created</a></code></td>
  </tr>
  <tr>
    <td><strong>4.</strong> <code>changed</code></td>
    <td><strong>20.</strong> <code><a href="#message-created">created</a></code></td>
    <td><strong>36.</strong> <code>crossed</code></td>
  </tr>
  <tr>
    <td><strong>5.</strong> <code><a href="#message-damaged">damaged</a></code></td>
    <td><strong>21.</strong> <code>deactivated</code></td>
    <td><strong>37.</strong> <code>deselected</code></td>
  </tr>
  <tr>
    <td><strong>6.</strong> <code>entered</code></td>
    <td><strong>22.</strong> <code>exited</code></td>
    <td><strong>38.</strong> <code>fire</code></td>
  </tr>
  <tr>
    <td><strong>7.</strong> <code><a href="#message-initialized">initialized</a></code></td>
    <td><strong>23.</strong> <code>join</code></td>
    <td><strong>39.</strong> <code>killed</code></td>
  </tr>
  <tr>
    <td><strong>8.</strong> <code>leave</code></td>
    <td><strong>24.</strong> <code>loading</code></td>
    <td><strong>40.</strong> <code>missed</code>
    <ul>
    <li><code>sender</code>: projectile weapon</li>
    <li><code>src</code>: shooter</li>
    <li>params: <code>p0</code> = <code>damageValue</code> <code>p1</code> = <code>damageType</code></li>
    </ul>

    </td>
  </tr>
  <tr>
    <td><strong>9.</strong> <code>newplayer</code></td>
    <td><strong>25.</strong> <code>pulse</code></td>
    <td><strong>41.</strong> <code><a href="#message-removed">removed</a></code></td>
  </tr>
  <tr>
    <td><strong>10.</strong> <code>respawn</code></td>
    <td><strong>26.</strong> <code>selected</code></td>
    <td><strong>42.</strong> <code>shutdown</code></td>
  </tr>
  <tr>
    <td><strong>11.</strong> <code>sighted</code></td>
    <td><strong>27.</strong> <code>splash</code> (when entering/exiting water)</td>
    <td><strong>43.</strong> <code>startup</code></td>
  </tr>
  <tr>
    <td><strong>12.</strong> <code>statechange</code></td>
    <td><strong>28.</strong> <code>taken</code></td>
    <td><strong>44.</strong> <code>timer</code></td>
  </tr>
  <tr>
    <td><strong>13.</strong> <code>touched</code></td>
    <td><strong>29.</strong> <code>trigger</code></td>
    <td><strong>45.</strong> <code>unboarded</code></td>
  </tr>
  <tr>
    <td><strong>14.</strong> <code>updatewpnts</code></td>
    <td><strong>30.</strong> <code><a href="#message-user0">user0</a></code></td>
    <td><strong>46.</strong> <code>user1</code></td>
  </tr>
  <tr>
    <td><strong>15.</strong> <code><a href="#message-user2">user2</a></code></td>
    <td><strong>31.</strong> <code>user3</code> (when cutscene ends)</td>
    <td><strong>47.</strong> <code>user4</code></td>
  </tr>
  <tr>
    <td><strong>16.</strong> <code>user5</code></td>
    <td><strong>32.</strong> <code>user6</code></td>
    <td><strong>48.</strong> <code>user7</code></td>
  </tr>
</table>

<h3 id="message-damaged">Message: damaged</h3>
<p>Message is received when sender is damaged.</p>
<table>
<thead>
<tr>
<th>Param</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>senderType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_SECTOR</code> | <code>COG_SYM_REF_SURFACE</code> | <code>COG_SYM_REF_THING</code></td>
</tr>
<tr>
<td><code>sender</code></td>
<td style="text-align: left;">Victim Thing object or damaged surface/sector</td>
</tr>
<tr>
<td><code>sourceType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_THING</code></td>
</tr>
<tr>
<td><code>source</code></td>
<td style="text-align: left;">Source thing object that caused the damage</td>
</tr>
<tr>
<td><code>Param0</code></td>
<td style="text-align: left;">The amount of damage to be inflicted</td>
</tr>
<tr>
<td><code>Param1</code></td>
<td style="text-align: left;">The <a href="flags.md#damage-class-flags">damage class type</a></td>
</tr>
<tr>
<td><code>Param2</code> - <code>Param3</code></td>
<td style="text-align: left;"><code>0</code> - not used</td>
</tr>
<tr>
<td><code>Return</code> (Optional)</td>
<td style="text-align: left;">In case victim is thing object, the return value can be set to override the damage amount to be actually inflicted. In this case if return value is 0 or less, no damage is inflicted.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In some cases the sender and source thing objects can be the same object, e.g.: Object hitting floor surface or object from height, actor drowning, raft actor punctured leak damage, IM part damage, etc.</p>
</div>
<h3 id="message-callback">Message: callback</h3>
<p>Message is sent by game engine to Thing COG script when <a href="pup.md#sub-mode-list">puppet submode</a> keyframe plays specific frame with <a href="key.md#markers">key marker</a>.</p>
<table>
<thead>
<tr>
<th>Param</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>senderType</code></td>
<td style="text-align: left;">COG_SYM_REF_THING</td>
</tr>
<tr>
<td><code>sender</code></td>
<td style="text-align: left;">Thing object for which the played puppet submode keyframe produced this event message</td>
</tr>
<tr>
<td><code>sourceType</code></td>
<td style="text-align: left;">COG_SYM_REF_NONE</td>
</tr>
<tr>
<td><code>source</code></td>
<td style="text-align: left;">0</td>
</tr>
<tr>
<td><code>Param0</code></td>
<td style="text-align: left;">Played track slot num of puppet submode which produced this event message</td>
</tr>
<tr>
<td><code>Param1</code></td>
<td style="text-align: left;"><a href="key.md#marker-types">Key marker type</a> which produced this event message</td>
</tr>
<tr>
<td><code>Param2</code> - <code>Param3</code></td>
<td style="text-align: left;"><code>0</code> - not used</td>
</tr>
</tbody>
</table>
<p>This event message is sent for these key marker types when actor is not in push/pull move state:</p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Action</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>16</code></td>
<td><code>Activate</code></td>
<td>Also sent when activate to board/disembark raft.</td>
</tr>
<tr>
<td><code>21</code></td>
<td><code>PlaceRightArm</code></td>
<td>Also sent at the end of disembarking raft animation.</td>
</tr>
<tr>
<td><code>22</code></td>
<td><code>PlaceRightArmRest</code></td>
<td>Also sent at the end of boarding raft animation.</td>
</tr>
<tr>
<td><code>23</code></td>
<td><code>ReachRightArm</code></td>
<td></td>
</tr>
<tr>
<td><code>24</code></td>
<td><code>ReachRightArmRest</code></td>
<td></td>
</tr>
<tr>
<td><code>25</code></td>
<td><code>Pickup</code></td>
<td></td>
</tr>
<tr>
<td><code>26</code></td>
<td><code>Drop</code></td>
<td></td>
</tr>
<tr>
<td><code>28</code></td>
<td><code>InventoryPull</code></td>
<td></td>
</tr>
<tr>
<td><code>29</code></td>
<td><code>InventoryPut</code></td>
<td></td>
</tr>
<tr>
<td><code>30</code></td>
<td><code>AttackFinish</code></td>
<td>Also sent at the end of boarding/disembarking raft animation.</td>
</tr>
<tr>
<td><code>31</code></td>
<td><code>TurnOff</code></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="message-created">Message: created</h3>
<p>Message is sent by game engine to Thing COG script after Thing object was created.</p>
<table>
<thead>
<tr>
<th>Param</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>senderType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_THING</code></td>
</tr>
<tr>
<td><code>sender</code></td>
<td style="text-align: left;">Thing for which the puppet submode is being played</td>
</tr>
<tr>
<td><code>sourceType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_NONE</code></td>
</tr>
<tr>
<td><code>source</code></td>
<td style="text-align: left;"><code>0</code></td>
</tr>
<tr>
<td><code>Param0</code> ... <code>Param3</code></td>
<td style="text-align: left;"><code>0</code></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Message is sent only when the engine is not in developer mode (<code>debugMode &amp; 0x100 [INEDITOR] == 0</code>).</p>
</div>
<h3 id="message-initialized">Message: initialized</h3>
<p>Message is sent by  game engine to Thing COG script after Thing object was initialized.</p>
<table>
<thead>
<tr>
<th>Param</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>senderType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_THING</code></td>
</tr>
<tr>
<td><code>sender</code></td>
<td style="text-align: left;">Thing that was initialized</td>
</tr>
<tr>
<td><code>sourceType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_NONE</code></td>
</tr>
<tr>
<td><code>source</code></td>
<td style="text-align: left;"><code>0</code></td>
</tr>
<tr>
<td><code>Param0</code> ... <code>Param3</code></td>
<td style="text-align: left;"><code>0</code></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Message is sent only when the engine is not in developer mode (<code>debugMode &amp; 0x100 [INEDITOR] == 0</code>).</p>
</div>
<h3 id="message-removed">Message: removed</h3>
<p>Message is sent by game engine to Thing COG script and COG script which captured Thing when the Thing object is removed from the game.</p>
<table>
<thead>
<tr>
<th>Param</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>senderType</code></td>
<td><code>COG_SYM_REF_THING</code></td>
</tr>
<tr>
<td><code>sender</code></td>
<td>Thing which is removed</td>
</tr>
<tr>
<td><code>sourceType</code></td>
<td><code>COG_SYM_REF_NONE</code></td>
</tr>
<tr>
<td><code>source</code></td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>Param0</code> ... <code>Param3</code></td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<h3 id="message-user0">Message: user0</h3>
<p>User defined message no. 0.</p>
<div class="admonition note">
<p class="admonition-title">Sent by the game engine</p>
<p>Sent to <code>weap_whip.cog</code> script by whip Thing object indicating that the whip swing mode has started.</p>
</div>
<table>
<thead>
<tr>
<th>Param</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>senderType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_THING</code></td>
</tr>
<tr>
<td><code>sender</code></td>
<td style="text-align: left;">Whip Thing</td>
</tr>
<tr>
<td><code>sourceType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_THING</code></td>
</tr>
<tr>
<td><code>source</code></td>
<td style="text-align: left;">Player Thing</td>
</tr>
<tr>
<td><code>Param0</code> ... <code>Param3</code></td>
<td style="text-align: left;"><code>0</code></td>
</tr>
</tbody>
</table>
<h3 id="message-user2">Message: user2</h3>
<p>User defined message no. 2.</p>
<div class="admonition note">
<p class="admonition-title">Sent by the game engine</p>
<p>When COG function <a href="#startcutscene-int-type-">StartCutscene</a> is called <code>user2</code> message is sent to the player Thing. The player is invulnerable during the cutscene.</p>
</div>
<table>
<thead>
<tr>
<th>Param</th>
<th style="text-align: left;">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>senderType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_THING</code></td>
</tr>
<tr>
<td><code>sender</code></td>
<td style="text-align: left;">Player Thing</td>
</tr>
<tr>
<td><code>sourceType</code></td>
<td style="text-align: left;"><code>COG_SYM_REF_NONE</code></td>
</tr>
<tr>
<td><code>source</code></td>
<td style="text-align: left;"><code>0</code></td>
</tr>
<tr>
<td><code>Param0</code> ... <code>Param3</code></td>
<td style="text-align: left;"><code>0</code></td>
</tr>
</tbody>
</table>
<h2 id="cog-host-functions">COG Host Functions</h2>
<p><strong><a href="cog_ai/">AI COG functions</a></strong><br />
<strong><a href="cog_jones/">Jones System COG functions</a></strong><br />
<strong><a href="cog_player/">Player COG functions</a></strong><br />
<strong><a href="cog_sector/">Sector COG functions</a></strong><br />
<strong><a href="cog_sound/">Sound COG functions</a></strong><br />
<strong><a href="cog_surface/">Surface COG functions</a></strong><br />
<strong><a href="cog_system/">System COG functions</a></strong><br />
<strong><a href="cog_thing/">Thing COG functions</a></strong><br />
<strong><a href="cog_voice/">Voice COG functions</a></strong></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes", "navigation.top"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>